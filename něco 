import tkinter as tk
import random

WIDTH, HEIGHT = 600, 400
BALL_RADIUS = 15
BALL_SPEED = 6
DANGER_SIZE = 30
DANGER_TIME = 5000  # 5 seconds

root = tk.Tk()
root.title("Horizontal Dodge Balls")
canvas = tk.Canvas(root, width=WIDTH, height=HEIGHT, bg="lightblue")
canvas.pack()

# horizontal lines for balls
ball_lines = [100, 170, 240, 310]
colors = ["white", "pink", "lavender", "lightyellow"]

# create balls
balls = []
for y, color in zip(ball_lines, colors):
    x = random.randint(50, WIDTH-50)
    ball_id = canvas.create_oval(x-BALL_RADIUS, y-BALL_RADIUS, x+BALL_RADIUS, y+BALL_RADIUS, fill=color)
    balls.append({
        "x": x,
        "y": y,
        "vx": BALL_SPEED,  # start moving right
        "id": ball_id
    })

# dangerous object
danger_x = random.randint(0, WIDTH-DANGER_SIZE)
danger_y = random.choice(ball_lines) - DANGER_SIZE//2  # appear only on a ball line
danger_id = canvas.create_rectangle(
    danger_x, danger_y,
    danger_x+DANGER_SIZE, danger_y+DANGER_SIZE,
    fill="orange"
)

# game over flag
game_over = False

def reverse_balls(event):
    for b in balls:
        b["vx"] = -b["vx"]

def move_danger():
    global danger_x, danger_y, danger_id, game_over
    if game_over:
        return
    danger_x = random.randint(0, WIDTH-DANGER_SIZE)
    danger_y = random.choice(ball_lines) - DANGER_SIZE//2
    canvas.coords(danger_id, danger_x, danger_y, danger_x+DANGER_SIZE, danger_y+DANGER_SIZE)
    root.after(DANGER_TIME, move_danger)

def tick():
    global game_over
    if game_over:
        return

    for b in balls:
        # move horizontally
        b["x"] += b["vx"]

        # bounce walls
        if b["x"]-BALL_RADIUS < 0:
            b["x"] = BALL_RADIUS
            b["vx"] = -b["vx"]
        elif b["x"]+BALL_RADIUS > WIDTH:
            b["x"] = WIDTH-BALL_RADIUS
            b["vx"] = -b["vx"]

        # update canvas
        canvas.coords(b["id"], b["x"]-BALL_RADIUS, b["y"]-BALL_RADIUS,
                      b["x"]+BALL_RADIUS, b["y"]+BALL_RADIUS)

        # check collision with dangerous object
        if (danger_x < b["x"] < danger_x + DANGER_SIZE) and (danger_y < b["y"] < danger_y + DANGER_SIZE):
            canvas.delete(danger_id)
            canvas.create_text(WIDTH//2, HEIGHT//2, text="BOOM!", fill="white", font=("Arial", 32, "bold"))
            game_over = True
            return

    root.after(16, tick)

canvas.bind("<Button-1>", reverse_balls)

move_danger()
tick()
root.mainloop()
